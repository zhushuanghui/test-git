<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" target-densitydpi="device-dpi"
          content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="stylesheet" type="text/css" href="iscroll/style/css/scrollbar.css">
    <style type="text/css" media="all">
        ::-webkit-scrollbar {
            width: 0;
            height: 0;
            background-color: #F5F5F5;
        }
        /*定义滚动条轨道 内阴影+圆角*/
        ::-webkit-scrollbar-track {
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);
            background: #fff ;
        }
        /*定义滑块 内阴影+圆角*/
        ::-webkit-scrollbar-thumb {
            border-radius: 3px;
            -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);
            background-color:#40bbf4;
        }
        body, ul, li {
            padding: 0;
            margin: 0;
            border: 0;
        }

        body {
            font-size: 12px;
            -webkit-user-select: none;
            -webkit-text-size-adjust: none;
            font-family: helvetica;
        }

        #footer {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 48px;
            background-image: -webkit-gradient(linear, 0 0, 0 100%, color-stop(0, #999), color-stop(0.02, #666), color-stop(1, #222));
            background-image: -moz-linear-gradient(top, #999, #666 2%, #222);
            background-image: -o-linear-gradient(top, #999, #666 2%, #222);
            padding: 0;
            border-top: 1px solid #444;
        }

        #wrapper {
            position: absolute;
            z-index: 1;
            top: 0px;
            bottom: 0px;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fefefe;
            overflow: auto;
        }

        #scroller {
            position: relative;
            /*	-webkit-touch-callout:none;*/
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            float: left;
            width: 100%;
            padding: 0;
        }

        #scroller ul {
            position: relative;
            list-style: none;
            padding: 0;
            margin: 0;
            width: 100%;
            text-align: left;
        }

        #scroller li {
            border-bottom: 1px solid #ccc;
            border-top: 1px solid #fff;
            background-color: #fafafa;
            font-size: 14px;
            position: relative;
        }

        #scroller li > a {
            display: block;
        }

        /**
         *
         * 下拉样式 Pull down styles
         *
         */
        #pullUp{
            display:none;
        }
        #information{
            display:none;
        }
        #pullDown, #pullUp {
            background: #fff;
            height: 48px;
            line-height: 40px;
            padding: 5px 10px;
            border-bottom: 1px solid #ccc;
            font-weight: bold;
            font-size: 14px;
            color: #888;
        }

        #pullDown .pullDownIcon, #pullUp .pullUpIcon {
            display: block;
            float: left;
            width: 40px;
            height: 40px;
            background: url(iscroll/style/images/img/pull-icon@2x.png) 0 0 no-repeat;
            -webkit-background-size: 40px 80px;
            background-size: 40px 80px;
            -webkit-transition-property: -webkit-transform;
            -webkit-transition-duration: 250ms;
        }

        #pullDown .pullDownIcon {
            -webkit-transform: rotate(0deg) translateZ(0);
        }

        #pullUp .pullUpIcon {
            -webkit-transform: rotate(-180deg) translateZ(0);
        }

        #pullDown.flip .pullDownIcon {
            -webkit-transform: rotate(-180deg) translateZ(0);
        }

        #pullUp.flip .pullUpIcon {
            -webkit-transform: rotate(0deg) translateZ(0);
        }

        #pullDown.loading .pullDownIcon, #pullUp.loading .pullUpIcon {
            background-position: 0 100%;
            -webkit-transform: rotate(0deg) translateZ(0);
            -webkit-transition-duration: 0ms;

            -webkit-animation-name: loading;
            -webkit-animation-duration: 2s;
            -webkit-animation-iteration-count: infinite;
            -webkit-animation-timing-function: linear;
        }

        @-webkit-keyframes loading {
            from {
                -webkit-transform: rotate(0deg) translateZ(0);
            }
            to {
                -webkit-transform: rotate(360deg) translateZ(0);
            }
        }

        #pullUp, #pullDown {
            text-align: center;
        }

        .pullUpIcon, .pullDownIcon {
            display: inline-block !important;
            float: inherit !important;
            vertical-align: middle;
        }

        /* CSS Document */

        * {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        body {
            font-family: Microsoft YaHei, Arial;
            font-size: 20px;
            background-color: #f2f2f2;
        }

        @media (min-width: 768px) {
            html {
                font-size: 16px;
            }
        }

        a, abbr, acronym, address, applet, article, aside, audio, b, big, blockquote, body, canvas, caption, center, cite, code, dd, del, details, dfn, div, dl, dt, em, embed, fieldset, figcaption, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, html, i, iframe, img, ins, kbd, label, legend, li, mark, menu, nav, object, ol, output, p, pre, q, ruby, s, samp, section, small, span, strike, strong, sub, summary, sup, table, tbody, td, tfoot, th, thead, time, tr, tt, u, ul, var, video, button {
            margin: 0;
            padding: 0;
            border: 0;
        }

        .clear {
            clear: both;
        }

        ul, ol, li {
            list-style: none;
        }

        a {
            color: #5e5e5e;
            text-decoration: none;
        }

        u {
            text-decoration: none;
        }

        .scroll {
            width: 100%;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
        }

        .mod_01 {
            float: left;
            width: 100%;
        }

        .mod_01 img {
            display: inline-block;
            width: 100%;
            height: 196px;
        }

        .dotModule_new {
            padding: 0 5px 5px 5px;
            height: 11px;
            line-height: 6px;
            -webkit-border-radius: 11px;
            z-index: 11;
            width: 12%;
            float: right
        }

        #slide_01_dot {
        }

        #slide_01_dot span {
            background: #c0a0d2;
            /*border: #c0a0d2 1px solid ;*/
            display: inline-block;
            width: 5px;
            height: 5px;
            border-radius: 5px;
            margin-right: 5px;
        }

        #slide_01_dot .selected {
            background: #fff;
        }

        /* top */

        .book_zhangjie1 {
            margin-bottom: 0.5em;
        }

        .book_zhangjie1 p {
            margin-top: 0.6em;
        }

        .tuijian img {
            width: 30px;
            vertical-align: middle;
            margin-right: 5px;
        }

        .game img {
            width: 25px;
            margin-right: 5px;
            margin-bottom: -5px;
        }

        .app_neir {
            width: 100%;
            background-color: #fff;
            font-size: 14px;
            padding-bottom: 7px; /*margin-top:1em; white-space:nowrap;overflow-x:auto;overflow:auto;*/
        }

        .app_neir div {
            width: 20%;
            padding: 0 2.5%;
            text-align: center;
            display: inline-block;
            margin-top: 10px;
        }

        .app_neir div a {
            display: inline-block;
            width: 48px;
            height: 48px;
            border-radius: 19px;
            margin-bottom: 5px
        }

        .app_neir div:nth-child(5) a img {
            width: 100%;
            border-radius: 0;
            margin-top: 0px;
        }

        .app_neir div:nth-child(6) a img {
            width: 100%;
            border-radius: 0;
            margin-top: 0px;
        }

        .app_neir div:nth-child(7) a img {
            width: 100%;
            border-radius: 0;
            margin-top: 0px;
        }

        .app_neir div:nth-child(8) a img {
            width: 100%;
            border-radius: 0;
            margin-top: 0px;
        }

        .app_neir img {
            width: 100%;
            margin-top: 6px;
        }

        .app_neir u {
            font-size: 12px;
            color: #ababab;
        }

        .book_fenkai {
            height: 0.625em;
            background: #f5f5f5;
            border-bottom: 1px solid #d3d3d3;
            border-top: 1px solid #e5e5e5;
            clear: both;
        }

        .guangg img {
            height: 100px;
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        * {
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        }

        li {
            list-style: none
        }

        .guangg {
            background: #696969 none repeat scroll 0 0;
            position: fixed;
            bottom: 0;
            text-align: center;
            width: 100%;
            height: 50px;
            overflow: hidden;
            margin: 0px auto;
            border: 0px solid #ffffff;
        }

        /*overflow: hidden;white-space: nowrap;text-overflow: ellipsis; 控制字体在一行 超出部分显示省略号*/
        .guangg a {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            width: 100%;
            height: 50px;
            line-height: 50px;
            text-indent: 20px;
            color: #ffffff;
            display: block;
            text-decoration: none;
        }

        li {
            list-style-type: none;
        }

        a {
            text-decoration: none;
            color: #626262;
        }

        .left {
            float: left;
        }

        .right {
            float: right;
        }

        nav p {
            text-align: center;
        }

        .wrap {
            width: 100%;
            min-width: 320px;
            margin: 0 auto;
        }

        nav {
            height: 50px;
            background-color: #009bdc;
            color: #fff;
            line-height: 48px;
            position: relative;
        }

        nav a {
            margin-left: 3%;
            padding-top: 10px;
            position: absolute;
        }

        nav span {
            margin-right: 41%;
        }

        #banner {
            position: relative;
            overflow: hidden;
        }

        #banner img {
            width: 100%;
        }

        #banner ul {
            position: absolute;
            bottom: 20px;
            left: 39%;
        }

        #banner ul li {
            width: 10px;
            height: 10px;
            float: left;
            border-radius: 50%;
            margin-right: 12px;
            background-color: #fff;
        }

        #banner .color {
            background-color: #f00;
        }

        #main {
            height: 335px;
            background-color: #fff;
            padding-top: 18px;
            margin-bottom: 10px;
            margin-top: -10px;
            border-bottom: 1px solid #ccc;
        }

        #btns {
            background-color: #fff;
            overflow: hidden;
            padding: 0 5%;
        }

        #btns dl {
            height: 135px;
            width: 25%;
            float: left;
            text-align: center;
            margin-top: 10px;
        }

        #btns dl:nth-child(5), #btns dl:nth-child(6), #btns dl:nth-child(7), #btns dl:nth-child(8) {
            margin-top: 25px;
        }

        #btns dl:last-child, #btns dl:nth-child(4) {
            margin-right: 0;
        }

        #btns dl dt {
            font-size: 20px;
            margin-top: 10px;
        }

        #information {
            background-color: #fff;
            border-top: 1px solid #ddd;
            padding: 0 10px;
        }

        .title {
            height: 44px;
            line-height: 44px;
            font-size: 18px;
            border-bottom: 1px solid #ddd;
        }

        .title .right {
            color: #009bdc;
            font-size: 16px;
        }

        .detail .right {
            width: 65%;
            padding-left: 2%;
        }

        .detail .left {
            width: 33%;
            max-width: 120px;
        }

        .detail .right p {
            height: 60px;
        }

        .detail a {
            font-size: 16px;
        }

        .detail .right i {
            display: inline-block;
            width: 15px;
            height: 20px;
            background: url("iscroll/style/css/img/pic_39.png") no-repeat 100%;
            margin-left: 50px;
            margin-right: 5px;
            vertical-align: middle;
            position: absolute;
            right: 57px;
            bottom: 13px;
        }

        .detail li {
            height: 85px;
            padding: 13px 0;
            overflow: hidden;
            border-bottom: 1px solid #ddd;
        }

        .detail span:last-child {
            width: 50px;
            display: inline-block;
        }

        .detail span, .detail i {
            font-size: 14px;
            color: #929292;
            position: absolute;
            bottom: 18px;
        }

        .detail li .right span:last-child {
            position: absolute;
            bottom: 15px;
            right: 10px;
        }

        .detail .left img {
            width: 100%;
        }

        footer {
            color: #929292;
        }

    #yingyong{
        padding:0 10px;
    }
    </style>
</head>
<body>
<div id="wrapper" style="min-height:530px;">
    <div id="scroller">
        <!-- 下拉动画 -->
        <div id="pullDown">
            <span class="pullDownIcon"></span><span class="pullDownLabel">下拉刷新...</span>
        </div>
        <div class="scroll">
            <div class="slide_01" id="slide_01"></div>
            <div class="slider-page"
                 style="position: absolute; bottom: 10px; right: 10px;">
                <div id="slide_01_dot"></div>
            </div>
        </div>
        <div>
            <div class="book_zhangjie1" id="yingyong">
                <div class="app_neir"></div>
            </div>
        </div>
        <!-- 新闻 -->
        <div id="information">
            <div class="title">
                <span class="left">新闻资讯</span>
                <span class="right"><a href="http://xw.qq.com/?refer=12306">更多>></a>&nbsp;&nbsp;</span>
            </div>
            <ul id="thelist" class="detail">

            </ul>
        </div>
        <!-- 上拉动画 -->
        <div id="pullUp">
            <span class="pullUpIcon"></span><span class="pullUpLabel">上拉加载更多...</span>
        </div>
    </div>
</div>
<script src="iscroll/style/js/jquery-1.11.3.min.js"></script>
<script type="application/javascript" src="iscroll/style/js/iscroll.js"></script>
<script type="text/javascript">
    var myScroll,
            pullDownEl, pullDownOffset,
            pullUpEl, pullUpOffset,
            generatedCount = 0;


    function pullDownAction() {
        setTimeout(function () {
            var el, li, i;
            el = document.getElementById('thelist');

            for (i = 0; i < 3; i++) {
                li = document.createElement('li');
                li.innerText = 'Generated row ' + (++generatedCount);
                el.insertBefore(li, el.childNodes[0]);
            }

            myScroll.refresh();
        }, 1000);
    }

    function pullUpAction() {
        setTimeout(function () {

            aa();
        }, 1000);
    }

    function loaded() {
        pullDownEl = document.getElementById('pullDown');
        pullDownOffset = pullDownEl.offsetHeight;
        pullUpEl = document.getElementById('pullUp');
        pullUpOffset = pullUpEl.offsetHeight;
        myScroll = new iScroll('wrapper', {
            scrollbarClass: 'myScrollbar',
            useTransition: false,
            topOffset: pullDownOffset,
            onRefresh: function () {
                if (pullDownEl.className.match('loading')) {
                    pullDownEl.className = '';
                    pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉刷新...';
                } else if (pullUpEl.className.match('loading')) {
                    pullUpEl.className = '';
                    pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多...';
                }
            },
            onScrollMove: function () {
                if (this.y > 5 && !pullDownEl.className.match('flip')) {
                    pullDownEl.className = 'flip';
                    pullDownEl.querySelector('.pullDownLabel').innerHTML = '松手开始更新...';
                    this.minScrollY = 0;
                } else if (this.y < 5 && pullDownEl.className.match('flip')) {
                    pullDownEl.className = '';
                    pullDownEl.querySelector('.pullDownLabel').innerHTML = '下拉刷新...';
                    this.minScrollY = -pullDownOffset;
                } else if (this.y < (this.maxScrollY - 5) && !pullUpEl.className.match('flip')) {
                    pullUpEl.className = 'flip';
                    pullUpEl.querySelector('.pullUpLabel').innerHTML = '松手开始更新...';
                    this.maxScrollY = this.maxScrollY;
                } else if (this.y > (this.maxScrollY + 5) && pullUpEl.className.match('flip')) {
                    pullUpEl.className = '';
                    pullUpEl.querySelector('.pullUpLabel').innerHTML = '上拉加载更多...';
                    this.maxScrollY = pullUpOffset;
                }
            },
            onScrollEnd: function () {
                if (pullDownEl.className.match('flip')) {
                    pullDownEl.className = 'loading';
                    pullDownEl.querySelector('.pullDownLabel').innerHTML = '加载中...';
                    pullDownAction();
                } else if (pullUpEl.className.match('flip')) {
                    pullUpEl.className = 'loading';
                    pullUpEl.querySelector('.pullUpLabel').innerHTML = '加载中...';
                    pullUpAction();
                }
            }
        });

        setTimeout(function () {
            document.getElementById('wrapper').style.left = '0';
        }, 800);
    }


    document.addEventListener('touchmove', function (e) {
        e.preventDefault();
    }, false);
    document.addEventListener('DOMContentLoaded', loaded, false);


    var contPath = "https://ad.12306.cn/sdk";
    var page = 0;
    var datJson = "";
    var TIME = "";
    var uuid = "";
    var data_0010 = "11";
    var data_0011;
    var u = navigator.userAgent;
    var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1;
    var isIOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);
    var clientType = "1";
    var url = "";

    //$(function () {
    if (isIOS) {
        clientType = "0";
    }
    getAd("0010");
    getAd("0011");
    getAd("0017");
    function imageSwipe() {
        var width = $(document.body).width();
        var height = 0.32 * width;
        $(".homebanner,.mod_01,.mod_01 img").css("width", width);
        $(".homebanner,.mod_01 img").css("height", height);
        if (document.getElementById("slide_01")) {
            var slide_01 = new ScrollPic();
            slide_01.scrollContId = "slide_01";
            slide_01.dotListId = "slide_01_dot";
            slide_01.dotOnClassName = "selected";
            slide_01.arrLeftId = "sl_left";
            slide_01.arrRightId = "sl_right";
            slide_01.frameWidth = width;
            slide_01.pageWidth = width;
            slide_01.upright = false;
            slide_01.speed = 30;
            slide_01.space = 50;
            slide_01.autoPlay = true;
            slide_01.autoPlayTime = 3;
            slide_01.initialize();
        }
    }

    function getAd(placementNo) {
        $.ajax({
            type: "get",
            url: contPath + "/webservice/rest/appService/getAdAppInfo.json?placementNo=" + placementNo + "&clientType=" + clientType,
            success: function (data) {
                if (data != null) {
                    init(placementNo, data);
                }
            }
        })
    }

    function init(placementNo, data) {
        if (placementNo == "0010") {
            var html = "";
            var s = 0;
            $.each(data.materialsList, function (i, n) {
                html += "<div class='mod_01'>";
                var linkUri = "#";
                if (n.linkUri != null && n.linkUri != "") {
                    linkUri = n.linkUri;
                    html += "<a href='javascript:onClickAdsImage(\"" + placementNo + "\",\"" + n.billMaterialsId + "\",\"" + linkUri + "\")'><img src='" + n.filePath + "'></img></a>";
                    html += "</div>";
                }
                else {
                    html += "<a href='javascript:void(0)'><img src='" + n.filePath + "'></img></a>";
                    html += "</div>";
                }
                s++;
            });
            $("#slide_01").html(html);
            if (s > 1) {
                imageSwipe();
            } else {
                $(".homebanner,.mod_01 img").css("height", 0.32 * $(document.body).width());
            }

        } else if (placementNo == "0011") {
            var html = "";
            $.each(data.materialsList, function (i, n) {
                var linkUri = "#";
                if (n.linkUri != null && n.linkUri != "") {
                    linkUri = n.linkUri;
                    html += "<div><a href='javascript:onClickAdsImage(\"" + placementNo + "\",\"" + n.billMaterialsId + "\",\"" + linkUri + "\")'><img src='" + n.filePath + "'/></a><br/>" + n.title + "<br/><u></u></div>";
                }
                else {
                    linkUri = 'javascript:void(0)';
                    html += "<div><a href='javascript:void(0)'><img src='" + n.filePath + "'/></a><br/>" + n.title + "<br/><u></u></div>";
                }
            });
            $("#yingyong").children(".app_neir").html(html);

        } else if (placementNo == "0017") {
            $.each(data.materialsList, function (i, n) {
                if (n.linkUri != null && n.linkUri != "") {
                    url = n.linkUri;
                    aa(url);
                } else {
                    $("#pullUp").css("display", "none");
                    $("#information").css("display", "none");
                }
            });
        }
    }

    function liulan(placementNo, billMaterialsId) {
        $.ajax({
            type: "get",
            url: contPath + "/appService/webservice/rest/appService/btnview.json?placementNo=" + placementNo + "&clientType=" + clientType + "&billMaterialsId=" + billMaterialsId + "&ip=" + uuid,
            success: function (data) {
            }
        })
    }

    function onClickAdsImage(placementNo, billMaterialsId, targetUrl) {
        if (isIOS) {
            location.href = "bontaiads://onClickAdsImage?id=" + billMaterialsId + "&targetUrl=" + encodeURIComponent(targetUrl);
        } else if (isAndroid) {
            window.bontaiAndroidJS.onClickAdsImage(billMaterialsId, targetUrl);
        }
        if (billMaterialsId)
            dianji(placementNo, billMaterialsId);
    }

    function dianji(placementNo, billMaterialsId) {
        $.ajax({
            type: "get",
            url: contPath + "/appService/webservice/rest/appService/btnhui.json?placementNo=" + placementNo + "&clientType=" + clientType + "&billMaterialsId=" + billMaterialsId + "&ip=" + uuid,
            success: function (data) {
            }
        })
    }

    function loadAdsSuccess(backuuid) {
        uuid = backuuid;
    }

    function autoScroll(obj) {
        $(obj).find("ul").animate({
            marginTop: "-50px"
        }, 500, function () {
            $(this).css({marginTop: "0px"}).find("li:first").appendTo(this);
        })
    }

    function getOtherData() {
        $.ajax({
            type: "get",
            url: "http://101.200.149.154/lyxx/webservice/rest/lyxxService/getTunXunData.json",
            success: function (data) {
                if (data != null && data.ret == 0) {
                    var html_other = "";
                    $.each(data.newslist, function (i, n) {
                        html_other += "<li><a  href='javascript:;' onclick=onClickAdsImage('','" + n.timestamp + "','" + n.url + "')>" + n.title + "</a></li>";
                    });

                    $(".other_data").html(html_other);
                    myScroll.refresh();
                    setInterval('autoScroll(".guangg")', 3000);
                }

            }
        })
    }

    function aa(url) {
        var url_1 = url.split("\" + page + \"");
        var url = url_1[0] + page + url_1[1];
        $.get(url, function (json) {
            json = $.parseJSON(json);
            var html_other = "";
            if (json.data.list.length != undefined && json.data.list.length > 0) {
                page += json.data.list.length;
                $.each(json.data.list, function (i, n) {
                    var title = n.content.title;
                    if (n.content.title.length >= 20) {
                        title = n.content.title.slice(0, 21) + "...";
                    }
                    if (n.content.articletype == 1) {
                        html_other = '<li onclick="onClickAdsImage(null, null, \'' + n.content.url + '\')"><div class="right"><p><a href="javascript:void(0);">' + title + '</p></a>' +
                        '<span>' + n.content.src + '</span><i></i><span>' + n.content.comment_count + '</span></div>' +
                        '<div class="left"><img src="' + n.content.image33_l[0] + '"/></div></li>';
                    } else {
                        html_other = '<li onclick="onClickAdsImage(null, null, \'' + n.content.url + '\')"><div class="right"><p><a href="javascript:void(0);">' + title + '</p></a>' +
                        '<span>' + n.content.src + '</span><i></i><span>' + n.content.comment_count + '</span></div>' +
                        '<div class="left"><img src="' + n.content.image32 + '"/></div></li>';
                    }
                    $(".detail").append(html_other);
                });
            } else {
                $(".pullUpIcon").hide();
                $(".pullUpLabel").html("没有更多了~");
            }
            $("#pullUp").css("display", "block");
            $("#information").css("display", "block");
            myScroll.refresh();
        });
    }

    //======================================================//
    var myScroll,
            pullDownEl, pullDownOffset,
            pullUpEl, pullUpOffset,
            generatedCount = 0;

    /*
     * 下拉刷新
     */
    function pullDownAction() {
        setTimeout(function () {
            location.reload();
            myScroll.refresh();
        }, 1000);
    }

    function pullUpAction() {
        setTimeout(function () {
            aa(url);
            myScroll.refresh();
        }, 1000);
    }
</script>
</body>
</html>
